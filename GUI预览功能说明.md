# GUI 预览功能说明

## 新增功能

### 1. 备份文件预览窗口

在系统托盘菜单中新增了"预览备份文件"选项，可以查看当前配置下哪些文件会被备份，哪些不会被备份。

**功能特点：**
- 显示所有启用的备份源中的文件
- 左侧列表显示会被备份的文件（绿色✓）
- 右侧列表显示不会被备份的文件（红色✗）
- 显示文件数量统计
- 最多显示1000个文件（避免扫描时间过长）

**使用方法：**
1. 右键点击系统托盘图标
2. 选择"预览备份文件"
3. 等待扫描完成（可能需要几秒钟）
4. 查看两个列表中的文件

### 2. 源配置对话框中的预览按钮

在添加或编辑备份源时，新增了"预览效果"按钮，可以在保存配置前预览当前设置的过滤效果。

**功能特点：**
- 实时预览当前配置的过滤效果
- 双列表显示：左侧显示会备份的文件，右侧显示不会备份的文件
- 显示文件数量统计
- 支持垂直和水平滚动条，方便查看长文件名
- 最多扫描500个文件（快速预览）

**使用方法：**
1. 在"备份设置"中点击"添加"或"配置"按钮
2. 选择要备份的路径
3. 配置预设或自定义过滤器
4. 点击"预览效果"按钮
5. 在弹出的预览窗口中查看两个列表
6. 使用滚动条浏览所有文件
7. 确认配置正确后，关闭预览窗口
8. 点击"确定"保存配置

## 使用场景

### 场景1：验证过滤规则
当你设置了复杂的白名单/黑名单规则时，可以使用预览功能确认规则是否按预期工作。

### 场景2：检查备份范围
在启动监控前，可以先预览一下会备份哪些文件，避免备份不必要的文件或遗漏重要文件。

### 场景3：调试配置
如果发现某些文件没有被备份，可以通过预览功能快速定位问题，看看这些文件是否在排除列表中。

## 注意事项

1. **扫描时间**：如果备份源包含大量文件，扫描可能需要一些时间
2. **文件数量限制**：
   - 全局预览最多显示1000个文件
   - 单个源预览最多显示500个文件
3. **权限问题**：如果某些目录没有访问权限，会被自动跳过
4. **实时性**：预览显示的是当前时刻的文件状态，实际备份时文件可能已经变化

## 技术细节

预览功能会：
1. 读取当前的配置文件
2. 合并预设和自定义过滤器
3. 递归扫描所有启用的备份源
4. 对每个文件应用过滤规则
5. 将结果分类显示

过滤规则优先级：
- 自定义过滤器 > 预设过滤器
- 双列表模式（白名单+黑名单）> 单模式
- 白名单优先：文件必须在白名单中且不在黑名单中
