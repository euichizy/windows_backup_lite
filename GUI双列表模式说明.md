# GUI双列表模式功能说明

## 功能概述

现在GUI支持**同时配置黑名单和白名单**，提供更灵活的文件过滤控制。

## 使用方法

### 1. 打开源配置对话框
- 在设置界面中添加或编辑备份源

### 2. 选择过滤模式

#### 单模式（原有功能）
- 不勾选"使用双列表模式"复选框
- 从下拉菜单选择：
  - **白名单**：只备份列表中的文件类型
  - **黑名单**：排除列表中的文件类型
  - **无**：备份所有文件
- 在扩展名列表中添加文件类型（如：.txt, .cpp）

#### 双列表模式（新功能）
- 勾选"使用双列表模式 (同时配置白名单和黑名单)"复选框
- 界面会切换显示两个列表：
  - **白名单**：仅备份这些类型的文件
  - **黑名单**：排除这些类型的文件
- 分别在两个列表中添加扩展名

### 3. 过滤规则

**双列表模式的逻辑**：
- 文件必须**在白名单中**
- 且**不在黑名单中**
- 才会被备份

**示例**：
- 白名单：`.cpp`, `.h`, `.txt`
- 黑名单：`.tmp.txt`, `.backup.cpp`
- 结果：
  - ✓ `main.cpp` - 会备份（在白名单，不在黑名单）
  - ✓ `header.h` - 会备份
  - ✓ `readme.txt` - 会备份
  - ✗ `temp.tmp.txt` - 不会备份（在黑名单）
  - ✗ `old.backup.cpp` - 不会备份（在黑名单）
  - ✗ `data.json` - 不会备份（不在白名单）

### 4. 预览功能
- 点击"预览效果"按钮可以查看当前配置会备份哪些文件
- 预览窗口会显示：
  - 左侧：会备份的文件列表
  - 右侧：不会备份的文件列表

## 技术细节

### 配置文件格式

双列表模式在配置文件中的表示：

```json
{
  "custom_filter": {
    "whitelist_extensions": [".cpp", ".h", ".txt"],
    "blacklist_extensions": [".tmp.txt", ".backup.cpp"]
  }
}
```

单模式在配置文件中的表示：

```json
{
  "custom_filter": {
    "mode": "whitelist",
    "extensions": [".cpp", ".h"]
  }
}
```

### 模式切换
- 切换模式时，原有的配置会被保留
- 保存时只会保存当前激活模式的配置
- 单模式和双列表模式互斥，不会同时生效

## 优势

1. **更精确的控制**：可以先用白名单限定大范围，再用黑名单排除特定文件
2. **灵活性**：适合复杂的过滤需求
3. **直观**：通过预览功能可以立即看到效果
4. **兼容性**：完全兼容原有的单模式配置

## 注意事项

- 如果白名单为空，双列表模式下不会备份任何文件
- 黑名单可以为空，此时等同于只使用白名单
- 自定义过滤器优先级高于预设
- 扩展名不区分大小写（.TXT 和 .txt 等效）
